<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-blog">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PK0DHL0FKW"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-PK0DHL0FKW",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Lam Tran" href="/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Lam Tran RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Lam Tran Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7172314318777821" async crossorigin="anonymous"></script><title data-rh="true">State Management In React</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://lam-tran.dev//blog/state-management-react"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="State Management In React | Lam Tran"><meta data-rh="true" name="description" content="State is a very crucial part of React applications which will help update the information of the React components to change UI accordingly and make our application interactive with clients. In this article, I will walk you through the usage of state, its characteristic, and how we can use state in an efficient way."><meta data-rh="true" property="og:description" content="State is a very crucial part of React applications which will help update the information of the React components to change UI accordingly and make our application interactive with clients. In this article, I will walk you through the usage of state, its characteristic, and how we can use state in an efficient way."><meta data-rh="true" property="og:image" content="https://lam-tran.dev//assets/images/showcase-eadae256672f0db4f02b6f535d28e46a.PNG"><meta data-rh="true" name="twitter:image" content="https://lam-tran.dev//assets/images/showcase-eadae256672f0db4f02b6f535d28e46a.PNG"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-06-26T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/lam1051999"><meta data-rh="true" property="article:tag" content="Web development,React,Html,Css"><link data-rh="true" rel="icon" href="/img/lt_logo.svg"><link data-rh="true" rel="canonical" href="https://lam-tran.dev//blog/state-management-react"><link data-rh="true" rel="alternate" href="https://lam-tran.dev//blog/state-management-react" hreflang="en"><link data-rh="true" rel="alternate" href="https://lam-tran.dev//blog/state-management-react" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://GIW3CHZWR8-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.2e718d97.css">
<link rel="preload" href="/assets/js/runtime~main.eec8c538.js" as="script">
<link rel="preload" href="/assets/js/main.67a129e3.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/lt_logo.svg" alt="TL Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/lt_logo.svg" alt="TL Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Lam Tran</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">About</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/how-is-memory-managed-in-spark">How Is Memory Managed In Spark?</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/state-management-react">State Management In React</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/mini-spark3-authorizer-part-2">Authorize Spark 3 SQL With Apache Ranger Part 2 - Integrate Spark SQL With Ranger</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/mini-spark3-authorizer-part-1">Authorize Spark 3 SQL With Apache Ranger Part 1 - Ranger installation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/spark-catalyst-optimizer-and-spark-session-extension">Spark Catalyst Optimizer And Spark Session Extension</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/mysql-series-mysql-indexing">MySQL series - Indexing</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/mysql-series-mysql-mvcc">MySQL series - Multiversion concurrency control</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/mysql-series-mysql-transaction">MySQL series - Transaction In MySQL</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/mysql-series-mysql-architecture">MySQL series - MySQL Architecture Overview</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/spark-kafka-docker">Create A Data Streaming Pipeline With Spark Streaming, Kafka And Docker</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/spark-cluster-docker">Create A Standalone Spark Cluster With Docker</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/avl-tree">AVL Tree, AVL Sorting Algorithm</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/binarysearch-tree">Binary Search Tree</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/sorting-algorithms">Fundamental Sorting Algorithms</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/peak-finding">Peak Finding Algorithm</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_Ikge" itemprop="headline">State Management In React</h1><div class="blogPostData_SAv4 margin-vert--md"><time datetime="2023-06-26T00:00:00.000Z" itemprop="datePublished">June 26, 2023</time> · <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_sTYa"><div class="avatar margin-bottom--sm"><a href="https://github.com/lam1051999" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/lam1051999.png" alt="Lam Tran"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/lam1051999" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Lam Tran</span></a></div><small class="avatar__subtitle" itemprop="description">Data Engineer</small></div></div></div></div></header><meta itemprop="image" content="https://lam-tran.dev//assets/images/showcase-eadae256672f0db4f02b6f535d28e46a.PNG"><div id="post-content" class="markdown" itemprop="articleBody"><p>State is a very crucial part of React applications which will help update the information of the React components to change UI accordingly and make our application interactive with clients. In this article, I will walk you through the usage of state, its characteristic, and how we can use state in an efficient way.</p><p><img loading="lazy" alt="showcase image" src="/assets/images/showcase-eadae256672f0db4f02b6f535d28e46a.PNG" width="1600" height="838" class="img_ev3q"></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-virtual-dom">1. Virtual DOM<a class="hash-link" href="#1-virtual-dom" title="Direct link to heading">​</a></h3><p>If you ever work with <code>React</code> or <code>Vue</code>, you probably know about a concept called Virtual DOM which those libraries/frameworks used to update the real DOM tree in the browser. Virtual DOM in React is a programming concept where the representation of a UI is kept in memory and synced with the real DOM.</p><p><img loading="lazy" alt="virtual dom" src="/assets/images/virtual_dom-ca44f9a796fe927bbe7356568b56c583.PNG" width="1846" height="896" class="img_ev3q"></p><p>In the picture above, whenever we have a UI in the browser on the left, we can inspect that UI and we can see the real DOM tree which contains several Html elements such as <code>div</code>, <code>ul</code>, <code>li</code>,... React will maintain a JavaScript object on the right to describe things on the real DOM and updates made to that object will be synchronized to the real DOM and modify the UI accordingly.</p><p>Thus, the Virtual DOM is a lightweight version of the real DOM, it provides a mechanism that abstracts manual DOM manipulations away from the developers, helping us to write more predictable code to interact with the real DOM.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-react-state">2. React state<a class="hash-link" href="#2-react-state" title="Direct link to heading">​</a></h3><p>State is a plain JavaScript object used by React to represent a piece of information about the component&#x27;s current situation. We modify state to manipulate the Virtual DOM.</p><p><img loading="lazy" alt="state change" src="/assets/images/state_change-c1929001d7e0813b2b6f28c4da758e46.PNG" width="1946" height="904" class="img_ev3q"></p><p>Whenever state changes, it will modify some properties of the Virtual DOM. React will compare the new Virtual DOM with the old one to detect those changes and will synchronize them to the real DOM. The interesting thing here is that update is only applied at the node where there is an actual change. So, how can React do the diffing algorithm in an efficient way?</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-diffing-algorithm">3. Diffing algorithm<a class="hash-link" href="#3-diffing-algorithm" title="Direct link to heading">​</a></h3><p>Diffing is the algorithm that React uses in order to find differences between two Virtual DOM trees and update efficiently the real DOM. In this section, I will just explain very high-level rules used by this algorithm.</p><p>When diffing two trees, React will first compare the two root elements.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31-rule-1">3.1. Rule #1<a class="hash-link" href="#31-rule-1" title="Direct link to heading">​</a></h4><p>Two elements of different types will produce different trees.</p><p><img loading="lazy" alt="rule 1" src="/assets/images/rule_1-df25c7a615e994971fd9a05d75014c9c.PNG" width="185" height="175" class="img_ev3q"></p><p>As shown in the picture, going from <code>&lt;div&gt;</code> to <code>&lt;span&gt;</code> will lead to full rebuild, its children will get unmounted and have their state destroyed.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="32-rule-2">3.2. Rule #2<a class="hash-link" href="#32-rule-2" title="Direct link to heading">​</a></h4><p>With the DOM elements of the same type, but different attributes, React knows to only modify the attribute that have been changed.</p><p>In this example, when the <code>className</code> attribute of the <code>&lt;input&gt;</code> is changed, React will only update that attribute instead of rebuilding the whole element.</p><p><img loading="lazy" alt="rule 2 1" src="/assets/images/rule_2_1-6b717be9810a4c9194ab680838cb7c2e.PNG" width="667" height="68" class="img_ev3q"></p><p>With object value attribute, React updates only the properties that have been changed.</p><p><img loading="lazy" alt="rule 2 2" src="/assets/images/rule_2_2-daad790845daff3462d43fad72227140.PNG" width="830" height="65" class="img_ev3q"></p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="33-rule-3">3.3. Rule #3<a class="hash-link" href="#33-rule-3" title="Direct link to heading">​</a></h4><p>This rule is about detecting the differences while recursing on children elements.</p><p><img loading="lazy" alt="rule 3 1" src="/assets/images/rule_3_1-8930e323c940480642e243d14840dd87.PNG" width="2118" height="578" class="img_ev3q"></p><p>React iterates over both lists of lists of children at the same time, and generates mutation whenever there&#x27;s a difference. As shown in above example, React will know to just generate the <code>List item 3</code> and append to the <code>ul</code> element.</p><p>So what if we prepend the list element instead of append? Because of iterating two lists at the same time and comparing, React will assume that all of those elements have been changed and rebuild all of them, which is a very bad case.</p><p><img loading="lazy" alt="rule 3 2" src="/assets/images/rule_3_2-1e44627cd3fea91062a9c8e255b576a6.PNG" width="1790" height="464" class="img_ev3q"></p><p>In order to get rid of the above case, we come to the <code>rule #4</code></p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="34-rule-4">3.4. Rule #4<a class="hash-link" href="#34-rule-4" title="Direct link to heading">​</a></h4><p>Developers can hint at which elements may be stable across different renders with a <code>key</code> prop, so that elements with the same key will be compared with each other</p><p><img loading="lazy" alt="rule 4" src="/assets/images/rule_4-31c6f9727e7d1c8672a9060005362eb3.PNG" width="2026" height="960" class="img_ev3q"></p><p>In the picture above, we add a <code>key</code> property to each <code>li</code> element so React will know to pair check the elements with the <code>key=&quot;item-1&quot;</code> and <code>key=&quot;item-2&quot;</code> and only add the element with <code>key=&quot;item-3&quot;</code> to the new DOM</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4-state-usage-with-usestate-hook">4. State usage with useState hook<a class="hash-link" href="#4-state-usage-with-usestate-hook" title="Direct link to heading">​</a></h3><p>The <code>useState</code> hook is a built-in React hook that allows you to manage state in a functional component.</p><p>Consider an example below</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// define React state in functional components</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">count</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> setCount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">useState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// update state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">setCount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">count </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">setCount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">prevCount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> prevCount </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>useState</code> returns an array contains the state (<code>count</code>) and a function used to update the state (<code>setCount</code>). The set function will take either the new value for the state or a callback function that returns new value as the argument.</p><p>There are some considerations when using state</p><ul><li><strong><code>setState</code> function is asynchronous:</strong> consider the below example, whenever we click the button to increase the count, we see the console logs the old value of state before it is updated. Because <code>setState</code> function is asynchronous, it will be pulled to an event loop, move to the lifecycle <code>Call stack -&gt; WebAPIs -&gt; Callback Queue -&gt; Call stack -&gt; being executed -&gt; Pop out the stack</code> (you can refer to event loop <strong><a href="https://www.webdevolution.com/blog/Javascript-Event-Loop-Explained" target="_blank" rel="noopener noreferrer">here</a></strong>), but basically, in JavaScript, in the same code block, the synchronous code will always run before the asynchronous code, that&#x27;s why we see the console logs the value of state before it is updated.</li></ul><p>Code: <code>UseStateM1.jsx</code>, tab <code>Mistake 1</code></p><iframe style="width:100%;height:900px;outline:1px solid #252525;border:0;border-radius:8px;margin-bottom:16px;z-index:100" src="https://codesandbox.io/s/state-management-24xt26?file=/src/components/UseStateM1.jsx"></iframe><ul><li><strong>Changes to state should be made by <code>setState</code> function:</strong> in this example, we can see that the count actually changes in the console log but the UI is not updated. Because we modify the state value directly and it will not cause the rerender of the component. In this case, we need to update state value by <code>setState</code> function: <code>setCount(count + 3)</code>.</li></ul><p>Code: <code>UseStateM2.jsx</code>, tab <code>Mistake 2</code></p><iframe style="width:100%;height:900px;outline:1px solid #252525;border:0;border-radius:8px;margin-bottom:16px;z-index:100" src="https://codesandbox.io/s/state-management-24xt26?file=/src/components/UseStateM2.jsx"></iframe><ul><li><strong>State should be treated as immutable:</strong> each time we use <code>setState</code> function, we need to pass a brand new value to the function in order to rerender the component. React uses Shallow Comparision to check if the state is changed or not. In JavaScript, with primitive datatypes such as numbers, strings,... SC will compare their values, with object datatypes such as object, array,... SC will compare their references. Consider the example below, when we modify the state object directly, the component will not be rerendered and the UI will not be updated because the state actually holds the reference to the user object, not its value. In order to fix this, we use the spread operator to create a new object to make a new reference, and update properties in that object <code>{ ...prevUser, name: &quot;No one&quot;, age: 30 }</code>, and our component will work as expected.</li></ul><p>Code: <code>UseStateM3.jsx</code>, tab <code>Mistake 3</code></p><iframe style="width:100%;height:900px;outline:1px solid #252525;border:0;border-radius:8px;margin-bottom:16px;z-index:100" src="https://codesandbox.io/s/state-management-24xt26?file=/src/components/UseStateM3.jsx"></iframe><ul><li><strong>Pass function as argument to <code>setState</code> whenever the state value depends on its previous value:</strong> in the example below, some might expect the value of <code>count</code> will increase 2 at a time, but it actually increases 1 because <code>setState</code> is an asynchronous function, it will not be executed immediately but pulled to the event loop, and those two <code>setState</code> functions will receive the same value <code>count = 0</code>. To fix this, we need to use <code>setCount((prev) =&gt; prev + 1)</code>, we make the output value depends on the previous value so no matter the order of execution of that two <code>setState</code>, the value will be increased by 2 at a time.</li></ul><p>Code: <code>UseStateM4.jsx</code>, tab <code>Mistake 4</code></p><iframe style="width:100%;height:900px;outline:1px solid #252525;border:0;border-radius:8px;margin-bottom:16px;z-index:100" src="https://codesandbox.io/s/state-management-24xt26?file=/src/components/UseStateM4.jsx"></iframe><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5-update-components-in-different-dom-tree-branches">5. Update components in different DOM tree branches<a class="hash-link" href="#5-update-components-in-different-dom-tree-branches" title="Direct link to heading">​</a></h3><p>State is often used within the body of a component and modify information about the component or its children, so, how can we sit in a component and modify the UI of other components that are in different scope?</p><p><img loading="lazy" alt="update different dom tree branches" src="/assets/images/update_different_dom_tree_branches-89aa911b833cef929d458aaedba35c75.PNG" width="1060" height="826" class="img_ev3q"></p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51-using-callback-functions">5.1. Using callback functions<a class="hash-link" href="#51-using-callback-functions" title="Direct link to heading">​</a></h4><p>In this approach, we are using callback functions in the child component to update state of the parent component, we also pass the state value from the parent to another child component to update its UI.</p><p>Code: <code>ByCallback.jsx</code>, tab <code>By Callback</code></p><iframe style="width:100%;height:900px;outline:1px solid #252525;border:0;border-radius:8px;margin-bottom:16px;z-index:100" src="https://codesandbox.io/s/state-management-24xt26?file=/src/pages/ByCallback.jsx"></iframe><p>In the code above, we define state in the <code>Root</code> component and pass the functions used to update state to <code>RootLeftLeft</code>, and pass the state value to <code>RootRightRight</code>. Now, we can sit in the <code>RootLeftLeft</code> and modify the UI of <code>RootRightRight</code> by updating the state in their common parent component.</p><p>Pros of this approach</p><ul><li>It does what we want, which is to update the UI of the component from other scopes.</li><li>Easy to use and pretty straightforward, use the React built-in hooks.</li></ul><p>Cons</p><ul><li>It will cause a lot of rerenders each time because the <code>Root</code> component is being rerendered, and so do its children.</li><li>Ugly code when we have many duplicates and we also need to pass the props in the intermediate components in the way from <code>Root</code> component to our target components.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52-using-react-context">5.2. Using React context<a class="hash-link" href="#52-using-react-context" title="Direct link to heading">​</a></h4><p>By using this approach, we can get rid of the ugly code problem in the first approach.</p><p>Code: <code>ByContext.jsx</code>, tab <code>By Context</code></p><iframe style="width:100%;height:900px;outline:1px solid #252525;border:0;border-radius:8px;margin-bottom:16px;z-index:100" src="https://codesandbox.io/s/state-management-24xt26?file=/src/pages/ByContext.jsx"></iframe><p>We define the <code>CountContext</code> context and provide it to our application part, we register the state value and the functions used to update state to the context, then, we use it directly in our target components, by using React <code>useContext</code> hook.</p><p>Even we don&#x27;t have the smelly code anymore, this approach still cannot solve the performance problem when all components of the tree are still being rerendered.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="53-using-redux">5.3. Using Redux<a class="hash-link" href="#53-using-redux" title="Direct link to heading">​</a></h4><p>Redux is a powerful state management library that will help us avoid rerendering too many components.</p><p>Redux has a concept called a single source of truth when we maintain our whole application state in a single store.</p><p>The state is Redux is read-only as we cannot mutate directly, the only way to change state is to emit an action.</p><p>Changes will be made by pure functions, so reducers are the pure functions, their output will only depend on the inputs and will not cause any side effects.</p><p>Code: <code>ByRedux.jsx</code>, tab <code>By Redux</code></p><iframe style="width:100%;height:900px;outline:1px solid #252525;border:0;border-radius:8px;margin-bottom:16px;z-index:100" src="https://codesandbox.io/s/state-management-24xt26?file=/src/pages/ByRedux.jsx"></iframe><p>In this example, we define <code>store</code> as our single source of truth, with a reducer to manage the count value and provide it within our application part. We create a slice and define functions to mutate the value in <code>store</code>. Action creators can be extracted from the slice and then they will be used everywhere within the context that <code>store</code> is provided.</p><p>In this way, the only component that gets rerendered is <code>RootRightRight</code>, when its props changed over time.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6-performance-considerations-when-interacting-with-state">6. Performance considerations when interacting with state<a class="hash-link" href="#6-performance-considerations-when-interacting-with-state" title="Direct link to heading">​</a></h3><p>There are some useful hooks/functions used to cache/memorize things related to state to avoid components from rerendering, which are</p><ul><li><code>React.memo()</code> for memorizing React components.</li><li><code>useMemo()</code> for memorizing some values.</li><li><code>useCallback()</code> for memorizing some callback functions.</li></ul><p>I will apply theses to the <strong><a href="#52-using-react-context">ByContext</a></strong> example above.</p><p>Code: <code>Memo.jsx</code>, tab <code>Memo</code></p><iframe style="width:100%;height:900px;outline:1px solid #252525;border:0;border-radius:8px;margin-bottom:16px;z-index:100" src="https://codesandbox.io/s/state-management-24xt26?file=/src/pages/Memo.jsx"></iframe><p>I use <code>useCallback</code> to memorize the callback functions used to update state, and prevent them from being recreated every time the <code>Root</code> component rerenders. Because the state value <code>count</code> changes over time so I will not cache that value.</p><p>I also use <code>React.memo()</code> to memorize the <code>RootLeft</code> component to prevent its rerendering when <code>Root</code> component rerenders (can also apply to other static components in the code, such as <code>RootRightLeft</code>,...).</p><p>Now, when we hit the increment/decrement buttons, we can see that event <code>Root</code> component rerenders, <code>RootLeft</code> and <code>RootLeftLeft</code> will not be rerendered.</p><p>This is pretty much about state management in React. Hope you enjoy reading it. See you in the next blogs.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="7-references">7. References<a class="hash-link" href="#7-references" title="Direct link to heading">​</a></h3><p><a href="https://legacy.reactjs.org/docs/reconciliation.html" target="_blank" rel="noopener noreferrer">Reconciliation</a></p><p><a href="https://www.geeksforgeeks.org/what-is-diffing-algorithm/" target="_blank" rel="noopener noreferrer">What is Diffing Algorithm ?</a></p><p><a href="https://www.webdevolution.com/blog/Javascript-Event-Loop-Explained" target="_blank" rel="noopener noreferrer">Javascript Event Loop Explained</a></p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_u0Nl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/web-development">Web development</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/react">React</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/html">Html</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/css">Css</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/lam1051999/blogs/edit/main/blog/2023-06-26-state-management-react/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><div class="margin-vert--xl"></div><div class="margin-vert--lg" style="display:flex;align-items:center;justify-content:center"><a class="button button--link" href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flam-tran.dev%2F%2Fblog%2Fstate-management-react&amp;text=I%20just%20read%20%22State%20Management%20In%20React%22%20by%20%40lamtt1005" target="_blank" rel="noreferrer noopener" style="display:inline-flex;align-items:center"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 248 204" height="20" width="20" style="margin-right:7px"><g><path fill="#1D9BF0" d="M221.95,51.29c0.15,2.17,0.15,4.34,0.15,6.53c0,66.73-50.8,143.69-143.69,143.69v-0.04 C50.97,201.51,24.1,193.65,1,178.83c3.99,0.48,8,0.72,12.02,0.73c22.74,0.02,44.83-7.61,62.72-21.66 c-21.61-0.41-40.56-14.5-47.18-35.07c7.57,1.46,15.37,1.16,22.8-0.87C27.8,117.2,10.85,96.5,10.85,72.46c0-0.22,0-0.43,0-0.64 c7.02,3.91,14.88,6.08,22.92,6.32C11.58,63.31,4.74,33.79,18.14,10.71c25.64,31.55,63.47,50.73,104.08,52.76 c-4.07-17.54,1.49-35.92,14.61-48.25c20.34-19.12,52.33-18.14,71.45,2.19c11.31-2.23,22.15-6.38,32.07-12.26 c-3.77,11.69-11.66,21.62-22.2,27.93c10.01-1.18,19.79-3.86,29-7.95C240.37,35.29,231.83,44.14,221.95,51.29z"></path></g></svg>Share on Twitter</a></div><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/how-is-memory-managed-in-spark"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">How Is Memory Managed In Spark?</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/mini-spark3-authorizer-part-2"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Authorize Spark 3 SQL With Apache Ranger Part 2 - Integrate Spark SQL With Ranger</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-virtual-dom" class="table-of-contents__link toc-highlight">1. Virtual DOM</a></li><li><a href="#2-react-state" class="table-of-contents__link toc-highlight">2. React state</a></li><li><a href="#3-diffing-algorithm" class="table-of-contents__link toc-highlight">3. Diffing algorithm</a><ul><li><a href="#31-rule-1" class="table-of-contents__link toc-highlight">3.1. Rule #1</a></li><li><a href="#32-rule-2" class="table-of-contents__link toc-highlight">3.2. Rule #2</a></li><li><a href="#33-rule-3" class="table-of-contents__link toc-highlight">3.3. Rule #3</a></li><li><a href="#34-rule-4" class="table-of-contents__link toc-highlight">3.4. Rule #4</a></li></ul></li><li><a href="#4-state-usage-with-usestate-hook" class="table-of-contents__link toc-highlight">4. State usage with useState hook</a></li><li><a href="#5-update-components-in-different-dom-tree-branches" class="table-of-contents__link toc-highlight">5. Update components in different DOM tree branches</a><ul><li><a href="#51-using-callback-functions" class="table-of-contents__link toc-highlight">5.1. Using callback functions</a></li><li><a href="#52-using-react-context" class="table-of-contents__link toc-highlight">5.2. Using React context</a></li><li><a href="#53-using-redux" class="table-of-contents__link toc-highlight">5.3. Using Redux</a></li></ul></li><li><a href="#6-performance-considerations-when-interacting-with-state" class="table-of-contents__link toc-highlight">6. Performance considerations when interacting with state</a></li><li><a href="#7-references" class="table-of-contents__link toc-highlight">7. References</a></li></ul></div></div></div></div></div><div class="footer-wrapper footer--dark"><div class="container margin-vert--lg"><div style="display:flex;justify-content:center"><div style="max-width:650px">I am a highly motivated and passionate data engineer. I often work with Python, Scala, and Java and use the latest big data technologies to solve problems, making tools to improve my and others&#x27; work productivity.<a target="_blank" rel="noreferrer noopener" href="https://www.buymeacoffee.com/lamtran" style="display:block;margin-top:10px"><img style="height:50px;width:50px" src="/img/donate.jpg"></a></div><div style="margin-left:30px;min-width:162px"><img src="/img/avatar.jpg" style="height:130px;width:136px"><p style="font-size:0.8em;margin-top:1em">Lam Tran<br>Data Engineer</p></div></div></div><div style="display:flex;justify-content:center"><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">About</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contact</div><ul class="footer__items clean-list"><li class="footer__item"><a href="mailto:lam1051999@gmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mail<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/lamtt1005" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="tel:+84962007024" target="_blank" rel="noopener noreferrer" class="footer__link-item">Phone<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/lam1051999" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Lam Tran. Powered by <a target="_blank" rel="noreferrer noopener" style="color:white;font-weight:bold;" href="https://docusaurus.io/">Docusaurus 2</a></div></div></div></footer></div></div></div>
<script src="/assets/js/runtime~main.eec8c538.js"></script>
<script src="/assets/js/main.67a129e3.js"></script>
</body>
</html>