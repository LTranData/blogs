"use strict";(self.webpackChunkkgajera_blog=self.webpackChunkkgajera_blog||[]).push([[614],{3905:(n,t,a)=>{a.d(t,{Zo:()=>s,kt:()=>m});var i=a(7294);function c(n,t,a){return t in n?Object.defineProperty(n,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[t]=a,n}function e(n,t){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.push.apply(a,i)}return a}function o(n){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?e(Object(a),!0).forEach((function(t){c(n,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):e(Object(a)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(a,t))}))}return n}function l(n,t){if(null==n)return{};var a,i,c=function(n,t){if(null==n)return{};var a,i,c={},e=Object.keys(n);for(i=0;i<e.length;i++)a=e[i],t.indexOf(a)>=0||(c[a]=n[a]);return c}(n,t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);for(i=0;i<e.length;i++)a=e[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(n,a)&&(c[a]=n[a])}return c}var r=i.createContext({}),h=function(n){var t=i.useContext(r),a=t;return n&&(a="function"==typeof n?n(t):o(o({},t),n)),a},s=function(n){var t=h(n.components);return i.createElement(r.Provider,{value:t},n.children)},g={inlineCode:"code",wrapper:function(n){var t=n.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(n,t){var a=n.components,c=n.mdxType,e=n.originalType,r=n.parentName,s=l(n,["components","mdxType","originalType","parentName"]),u=h(a),m=c,k=u["".concat(r,".").concat(m)]||u[m]||g[m]||e;return a?i.createElement(k,o(o({ref:t},s),{},{components:a})):i.createElement(k,o({ref:t},s))}));function m(n,t){var a=arguments,c=t&&t.mdxType;if("string"==typeof n||c){var e=a.length,o=new Array(e);o[0]=u;var l={};for(var r in t)hasOwnProperty.call(t,r)&&(l[r]=t[r]);l.originalType=n,l.mdxType="string"==typeof n?n:c,o[1]=l;for(var h=2;h<e;h++)o[h]=a[h];return i.createElement.apply(null,o)}return i.createElement.apply(null,a)}u.displayName="MDXCreateElement"},752:(n,t,a)=>{a.r(t),a.d(t,{assets:()=>r,contentTitle:()=>o,default:()=>g,frontMatter:()=>e,metadata:()=>l,toc:()=>h});var i=a(7462),c=(a(7294),a(3905));const e={slug:"mysql-series-mysql-transaction",title:"MySQL series - Transaction trong MySQL",authors:"tranlam",tags:["Bigdata","MySQL","Database","Data Engineering","Transaction"],image:"./images/acid.PNG"},o=void 0,l={permalink:"/blogs/blog/mysql-series-mysql-transaction",editUrl:"https://github.com/lam1051999/blogs/edit/main/blog/2022-10-06-mysql-transaction/index.md",source:"@site/blog/2022-10-06-mysql-transaction/index.md",title:"MySQL series - Transaction trong MySQL",description:"B\xe0i vi\u1ebft ti\u1ebfp theo trong series MySQL v\u1ec1 transaction. M\u1ed9t ho\u1ea1t \u0111\u1ed9ng r\u1ea5t ph\u1ed5 bi\u1ebfn trong MySQL n\xf3i ri\xeang v\xe0 c\xe1c c\u01a1 s\u1edf d\u1eef li\u1ec7u quan h\u1ec7 n\xf3i chung. C\xf9ng \u0111i v\xe0o b\xe0i vi\u1ebft n\xe0o.",date:"2022-10-06T00:00:00.000Z",formattedDate:"October 6, 2022",tags:[{label:"Bigdata",permalink:"/blogs/blog/tags/bigdata"},{label:"MySQL",permalink:"/blogs/blog/tags/my-sql"},{label:"Database",permalink:"/blogs/blog/tags/database"},{label:"Data Engineering",permalink:"/blogs/blog/tags/data-engineering"},{label:"Transaction",permalink:"/blogs/blog/tags/transaction"}],readingTime:6.455,truncated:!0,authors:[{name:"Tr\u1ea7n L\xe2m",title:"Data Engineer @ Giaohangtietkiem",url:"https://github.com/lam1051999",imageURL:"https://github.com/lam1051999.png",key:"tranlam"}],frontMatter:{slug:"mysql-series-mysql-transaction",title:"MySQL series - Transaction trong MySQL",authors:"tranlam",tags:["Bigdata","MySQL","Database","Data Engineering","Transaction"],image:"./images/acid.PNG"},nextItem:{title:"MySQL series - T\u1ed5ng quan ki\u1ebfn tr\xfac MySQL",permalink:"/blogs/blog/mysql-series-mysql-architecture"}},r={image:a(7959).Z,authorsImageUrls:[void 0]},h=[{value:"1. Transaction l\xe0 g\xec?",id:"1-transaction-l\xe0-g\xec",level:3},{value:"2. 4 t\xednh ch\u1ea5t b\u1ea3o to\xe0n d\u1eef li\u1ec7u trong c\u01a1 s\u1edf d\u1eef li\u1ec7u quan h\u1ec7",id:"2-4-t\xednh-ch\u1ea5t-b\u1ea3o-to\xe0n-d\u1eef-li\u1ec7u-trong-c\u01a1-s\u1edf-d\u1eef-li\u1ec7u-quan-h\u1ec7",level:3},{value:"3. 4 isolation level trong m\xf4i tr\u01b0\u1eddng c\xf3 nhi\u1ec1u \u0111\u1ecdc ghi \u0111\u1ed3ng th\u1eddi",id:"3-4-isolation-level-trong-m\xf4i-tr\u01b0\u1eddng-c\xf3-nhi\u1ec1u-\u0111\u1ecdc-ghi-\u0111\u1ed3ng-th\u1eddi",level:3},{value:"4. Deadlock trong transaction",id:"4-deadlock-trong-transaction",level:3},{value:"5. Transaction logging",id:"5-transaction-logging",level:3},{value:"6. Autocommit",id:"6-autocommit",level:3}],s={toc:h};function g(n){let{components:t,...e}=n;return(0,c.kt)("wrapper",(0,i.Z)({},s,e,{components:t,mdxType:"MDXLayout"}),(0,c.kt)("p",null,"B\xe0i vi\u1ebft ti\u1ebfp theo trong series MySQL v\u1ec1 transaction. M\u1ed9t ho\u1ea1t \u0111\u1ed9ng r\u1ea5t ph\u1ed5 bi\u1ebfn trong MySQL n\xf3i ri\xeang v\xe0 c\xe1c c\u01a1 s\u1edf d\u1eef li\u1ec7u quan h\u1ec7 n\xf3i chung. C\xf9ng \u0111i v\xe0o b\xe0i vi\u1ebft n\xe0o."),(0,c.kt)("h3",{id:"1-transaction-l\xe0-g\xec"},"1. Transaction l\xe0 g\xec?"),(0,c.kt)("p",null,"Transaction l\xe0 m\u1ed9t t\u1eadp c\xe1c c\xe2u l\u1ec7nh SQL k\u1ebft h\u1ee3p v\u1edbi nhau nh\u01b0 l\xe0 m\u1ed9t \u0111\u01a1n v\u1ecb c\xf4ng vi\u1ec7c. N\u1ebfu nh\u01b0 database ch\u1ea1y th\xe0nh c\xf4ng to\xe0n b\u1ed9 l\u1ec7nh SQL trong nh\xf3m \u0111\xf3, n\xf3 \u0111\u01b0\u1ee3c coi l\xe0 th\xe0nh c\xf4ng. N\u1ebfu nh\u01b0 m\u1ed9t trong s\u1ed1 l\u1ec7nh SQL g\u1eb7p l\u1ed7i, t\u1ea5t c\u1ea3 c\xe1c l\u1ec7nh SQL \u0111\xe3 ch\u1ea1y ho\u1eb7c ch\u01b0a ch\u1ea1y s\u1ebd kh\xf4ng \u1ea3nh h\u01b0\u1edfng g\xec t\u1edbi database. V\xed d\u1ee5 c\xe1c m\u1ed9t t\u1eadp c\xe2u l\u1ec7nh SQL g\xf3i trong m\u1ed9t transaction sau"),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-mysql"},"    1  START  TRANSACTION;\n    2  SELECT balance FROM checking WHERE customer_id = 10233276;\n    3  UPDATE checking SET balance = balance - 200.00 WHERE customer_id = 10233276;\n    4  UPDATE savings SET balance = balance - 200.00 WHERE customer_id = 10233276;\n    5  COMMIT;\n")),(0,c.kt)("p",null,"Transaction \u0111\u01b0\u1ee3c b\u1eaft \u0111\u1ea7u b\u1edfi START TRANSACTION v\xe0 th\u01b0\u1eddng \u0111\u01b0\u1ee3c \u0111\xf3ng b\u1edfi COMMIT (x\xe1c nh\u1eadn th\u1ef1c hi\u1ec7n transaction) ho\u1eb7c ROLLBACK (tr\u1edf l\u1ea1i tr\u1ea1ng th\xe1i tr\u01b0\u1edbc khi transaction). N\u1ebfu nh\u01b0 c\xe2u l\u1ec7nh th\u1ee9 4 b\u1ecb l\u1ed7i, c\xe2u l\u1ec7nh th\u1ee9 3 s\u1ebd \u0111\u01b0\u1ee3c rollback v\xe0 kh\xf4ng c\xf3 g\xec x\u1ea3y ra \u1ea3nh h\u01b0\u1edfng t\u1edbi d\u1eef li\u1ec7u c\u0169."),(0,c.kt)("h3",{id:"2-4-t\xednh-ch\u1ea5t-b\u1ea3o-to\xe0n-d\u1eef-li\u1ec7u-trong-c\u01a1-s\u1edf-d\u1eef-li\u1ec7u-quan-h\u1ec7"},"2. 4 t\xednh ch\u1ea5t b\u1ea3o to\xe0n d\u1eef li\u1ec7u trong c\u01a1 s\u1edf d\u1eef li\u1ec7u quan h\u1ec7"),(0,c.kt)("p",null,(0,c.kt)("img",{alt:"ACID",src:a(7959).Z,width:"875",height:"489"})),(0,c.kt)("p",null,"M\u1ed7i m\u1ed9t h\u1ec7 th\u1ed1ng c\u1ea7n tho\u1ea3 m\xe3n 4 t\xednh ch\u1ea5t ACID \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o an to\xe0n v\u1ec1 d\u1eef li\u1ec7u"),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"Atomicity")),(0,c.kt)("p",null,"Transaction c\u1ea7n ho\u1ea1t \u0111\u1ed9ng nh\u01b0 m\u1ed9t \u0111\u01a1n v\u1ecb c\xf4ng vi\u1ec7c. Ho\u1eb7c l\xe0 t\u1ea5t c\u1ea3 c\xe2u l\u1ec7nh SQL trong transaction \u0111\u01b0\u1ee3c \xe1p d\u1ee5ng ho\u1eb7c l\xe0 kh\xf4ng c\xf3 c\xe2u l\u1ec7nh n\xe0o \u0111\u01b0\u1ee3c \xe1p d\u1ee5ng."),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"Consistency")),(0,c.kt)("p",null,"Database c\u1ea7n c\xf3 t\xednh nh\u1ea5t qu\xe1n, ch\u1ec9 \u0111\u01b0\u1ee3c chuy\u1ec3n t\u1eeb tr\u1ea1ng th\xe1i nh\u1ea5t qu\xe1n n\xe0y \u0111\u1ebfn tr\u1ea1ng th\xe1i nh\u1ea5t qu\xe1n kh\xe1c. V\xed d\u1ee5 \u1edf b\xean tr\xean, n\u1ebfu l\u1ed7i x\u1ea3y ra sau khi ch\u1ea1y xong c\xe2u th\u1ee9 3, t\xe0i kho\u1ea3n checking s\u1ebd kh\xf4ng b\u1ecb m\u1ea5t \u0111i 200 ti\u1ec1n khi transaction ch\u01b0a commit. T\u1ed5ng ti\u1ec1n \u1edf hai t\xe0i kho\u1ea3n tr\u01b0\u1edbc v\xe0 sau v\u1eabn gi\u1eef nguy\xean."),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"Isolation")),(0,c.kt)("p",null,"K\u1ebft qu\u1ea3 c\u1ee7a transaction n\xe0y s\u1ebd v\xf4 h\xecnh \u0111\u1ed1i v\u1edbi c\xe1c transaction kh\xe1c khi transaction n\xe0y ch\u01b0a k\u1ebft th\xfac, ch\u01b0a commit. V\xed d\u1ee5 khi transaction 1 \u0111ang ch\u1ea1y gi\u1eefa c\xe2u 3 v\xe0 c\xe2u 4 b\xean tr\xean, m\u1ed9t transaction kh\xe1c t\xednh to\xe1n t\xf3m l\u01b0\u1ee3c l\u1ea1i s\u1ed1 d\u01b0 c\xe1c t\xe0i kho\u1ea3n s\u1ebd v\u1eabn nh\xecn th\u1ea5y 200 ti\u1ec1n \u1edf trong t\xe0i kho\u1ea3n checking. Khi m\u1ed9t transaction ch\u01b0a commit, kh\xf4ng c\xf3 s\u1ef1 thay \u0111\u1ed5i n\xe0o s\u1ebd \u1ea3nh h\u01b0\u1edfng l\xean database."),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"Durability")),(0,c.kt)("p",null,"M\u1ed9t khi commit, c\xe1c thay \u0111\u1ed5i b\u1edfi transaction s\u1ebd t\u1ed3n t\u1ea1i l\xe2u d\xe0i, c\xe1c s\u1ef1 thay \u0111\u1ed5i \u0111\xf3 c\u1ea7n \u0111\u01b0\u1ee3c ghi ch\xe9p l\u1ea1i \u0111\u1ea3m b\u1ea3o vi\u1ec7c d\u1eef li\u1ec7u kh\xf4ng b\u1ecb m\u1ea5t n\u1ebfu h\u1ec7 th\u1ed1ng b\u1ecb l\u1ed7i."),(0,c.kt)("h3",{id:"3-4-isolation-level-trong-m\xf4i-tr\u01b0\u1eddng-c\xf3-nhi\u1ec1u-\u0111\u1ecdc-ghi-\u0111\u1ed3ng-th\u1eddi"},"3. 4 isolation level trong m\xf4i tr\u01b0\u1eddng c\xf3 nhi\u1ec1u \u0111\u1ecdc ghi \u0111\u1ed3ng th\u1eddi"),(0,c.kt)("p",null,"C\xf3 4 isolation level li\xean quan t\u1edbi transaction"),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"READ UNCOMMITTED")),(0,c.kt)("p",null,"\u1ede ch\u1ebf \u0111\u1ed9 n\xe0y, c\xe1c transactions c\xf3 th\u1ec3 nh\xecn th\u1ea5y k\u1ebft qu\u1ea3 c\u1ee7a c\xe1c transactions ch\u01b0a commit kh\xe1c. Ch\u1ebf \u0111\u1ed9 n\xe0y hi\u1ec7u n\u0103ng kh\xf4ng nhanh h\u01a1n qu\xe1 nhi\u1ec1u ch\u1ebf \u0111\u1ed9 kh\xe1c nh\u01b0ng d\u1ec5 g\xe2y nhi\u1ec1u v\u1ea5n \u0111\u1ec1 khi \u0111\u1ecdc d\u1eef li\u1ec7u sai."),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"READ COMMITTED")),(0,c.kt)("p",null,"Ch\u1ebf \u0111\u1ed9 m\u1eb7c \u0111\u1ecbnh c\u1ee7a h\u1ea7u h\u1ebft c\xe1c database (nh\u01b0ng kh\xf4ng ph\u1ea3i MySQL), n\xf3 s\u1ebd l\xe0m m\u1ea5t \u0111i m\u1ed9t s\u1ed1 \u0111\u1eb7c t\xednh trong t\xednh Isolation c\u1ee7a ACID, transaction n\xe0y s\u1ebd c\xf3 th\u1ec3 nh\xecn th\u1ea5y c\xe1c s\u1ef1 thay \u0111\u1ed5i b\u1edfi c\xe1c transactions kh\xe1c \u0111\u01b0\u1ee3c commit sau khi transaction n\xe0y b\u1eaft \u0111\u1ea7u, tuy nhi\xean s\u1ef1 thay \u0111\u1ed5i c\u1ee7a transaction n\xe0y v\u1eabn v\xf4 h\xecnh cho \u0111\u1ebfn khi n\xf3 \u0111\u01b0\u1ee3c commit. \u0110i\u1ec1u n\xe0y c\xf3 th\u1ec3 g\xe2y ra vi\u1ec7c hai c\xe2u l\u1ec7nh \u0111\u1ecdc gi\u1ed1ng nhau trong m\u1ed9t transaction c\xf3 th\u1ec3 tr\u1ea3 v\u1ec1 c\xe1c d\u1eef li\u1ec7u kh\xe1c nhau."),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"REPEATABLE READ ")),(0,c.kt)("p",null,"Ch\u1ebf \u0111\u1ed9 n\xe0y l\xe0 m\u1eb7c \u0111\u1ecbnh c\u1ee7a MySQL. N\xf3 \u0111\u1ea3m b\u1ea3o r\u1eb1ng trong c\xf9ng m\u1ed9t transaction, c\xe1c c\xe2u l\u1ec7nh \u0111\u1ecdc gi\u1ed1ng nhau s\u1ebd tr\u1ea3 v\u1ec1 c\xf9ng m\u1ed9t k\u1ebft qu\u1ea3 gi\u1ed1ng nhau. Nh\u01b0ng c\u0169ng s\u1ebd c\xf3 m\u1ed9t v\u1ea5n \u0111\u1ec1 nh\u1ecf x\u1ea3y ra l\xe0 n\u1ebfu ta select m\u1ed9t kho\u1ea3ng gi\xe1 tr\u1ecb, m\u1ed9t transaction kh\xe1c ch\xe8n b\u1ea3n ghi m\u1edbi v\xe0o kho\u1ea3ng gi\xe1 tr\u1ecb \u0111\xf3, ta s\u1ebd nh\xecn th\u1ea5y b\u1ea3n ghi m\u1edbi \u0111\xf3. C\xe1c storage engines nh\u01b0 InnDB, XtraDB gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\xe0y b\u1eb1ng vi\u1ec7c t\u1ea1o ra nhi\u1ec1u phi\xean b\u1ea3n qu\u1ea3n l\xfd vi\u1ec7c \u0111\u1ecdc ghi \u0111\u1ed3ng th\u1eddi."),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"SERIALIZABLE")),(0,c.kt)("p",null,"Ch\u1ebf \u0111\u1ed9 n\xe0y gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 \u0111\u1ecdc m\u1ed9t kho\u1ea3ng gi\xe1 tr\u1ecb b\xean tr\xean b\u1eb1ng vi\u1ec7c ch\u1ea1y c\xe1c transactions theo m\u1ed9t th\u1ee9 t\u1ef1. Ch\u1ebf \u0111\u1ed9 n\xe0y s\u1ebd kho\xe1 t\u1ea5t c\u1ea3 row m\xe0 n\xf3 \u0111\u1ecdc, r\u1ea5t nhi\u1ec1u timeout v\xe0 vi\u1ec7c kho\xe1 x\u1ea3y ra th\u01b0\u1eddng xuy\xean, t\xednh \u0111\u1ecdc ghi \u0111\u1ed3ng th\u1eddi s\u1ebd b\u1ecb gi\u1ea3m xu\u1ed1ng."),(0,c.kt)("p",null,(0,c.kt)("img",{alt:"Isolation Level",src:a(4466).Z,width:"1318",height:"316"})),(0,c.kt)("h3",{id:"4-deadlock-trong-transaction"},"4. Deadlock trong transaction"),(0,c.kt)("p",null,"Deadlock x\u1ea3y ra khi hai ho\u1eb7c nhi\u1ec1u c\xe1c transactions kho\xe1 c\u0169ng c\xe1c t\xe0i nguy\xean, t\u1ea1o ra m\u1ed9t v\xf2ng tr\xf2n ph\u1ee5 thu\u1ed9c"),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-mysql"},"-- Transaction 1 \n    START TRANSACTION;\n    UPDATE StockPrice SET close = 45.50 WHERE stock_id = 4 and date = \u20182020-05-01\u2019;\n    UPDATE StockPrice SET close = 19.80 WHERE stock_id = 3 and date = \u20182020-05-02\u2019;\n    COMMIT;\n-- Transaction 2 \n    START TRANSACTION;\n    UPDATE StockPrice SET high = 20.12 WHERE stock_id = 3 and date = \u20182020-05-02\u2019;\n    UPDATE StockPrice SET high = 47.20 WHERE stock_id = 4 and date = \u20182020-05-01\u2019;\n    COMMIT;\n")),(0,c.kt)("p",null,"Sau khi 2 transaction n\xe0y ch\u1ea1y xong l\u1ec7nh \u0111\u1ea7u ti\xean, khi ch\u1ea1y l\u1ec7nh th\u1ee9 2. C\xe1c b\u1ea3n ghi v\u1edbi id t\u01b0\u01a1ng \u1ee9ng c\u1ee7a transaction n\xe0y \u0111ang b\u1ecb kho\xe1 b\u1edfi transaction kh\xe1c, c\u0169ng nh\u01b0 transaction kh\xe1c b\u1ecb kho\xe1 b\u1edfi transaction n\xe0y. InnoDB s\u1ebd tr\u1ea3 v\u1ec1 l\u1ed7i n\u1ebfu ph\xe1t hi\u1ec7n m\u1ed9t v\xf2ng tr\xf2n ph\u1ee5 thu\u1ed9c. C\xe1ch m\xe0 InnoDB x\u1eed l\xfd deadlock l\xe0 n\xf3 s\u1ebd rollback transaction c\xf3 \xedt row b\u1ecb lock nh\u1ea5t."),(0,c.kt)("p",null,(0,c.kt)("img",{alt:"Deadlock",src:a(8532).Z,width:"1910",height:"1042"})),(0,c.kt)("h3",{id:"5-transaction-logging"},"5. Transaction logging"),(0,c.kt)("p",null,"Transaction logging khi\u1ebfn vi\u1ec7c th\u1ef1c hi\u1ec7n transaction th\xeam hi\u1ec7u qu\u1ea3 h\u01a1n. Thay v\xec c\u1eadp nh\u1eadt th\u1eb3ng v\xe0o b\u1ea3ng \u1edf disk m\u1ed7i khi c\xf3 s\u1ef1 thay \u0111\u1ed5i n\xe0o \u0111\xf3, n\xf3 c\u1eadp nh\u1eadt v\xe0o b\u1ea3ng copy c\u1ee7a d\u1eef li\u1ec7u trong b\u1ed9 nh\u1edb (in-memory). Sau \u0111\xf3 c\xe1c transaction log s\u1ebd \u0111\u01b0\u1ee3c ghi xu\u1ed1ng disk v\u1edbi mode append, ho\u1ea1t \u0111\u1ed9ng n\xe0y r\u1ea5t nhanh v\xec ch\u1ec9 y\xeau c\u1ea7u I/O tu\u1ea7n t\u1ef1 trong disk, hi\u1ec7u qu\u1ea3 v\u1ec1 chi ph\xed h\u01a1n, m\u1ed9t th\u1eddi gian sau c\xe1c thay \u0111\u1ed5i n\xe0y m\u1edbi \u0111\u01b0\u1ee3c \xe1p d\u1ee5ng v\xe0o d\u1eef li\u1ec7u th\u1ef1c \u1edf disk. B\u1edfi v\xec log n\xe0y \u0111\u01b0\u1ee3c ghi tr\xean disk n\xean n\xf3 s\u1ebd t\u1ed3n t\u1ea1i l\xe2u, n\u1ebfu h\u1ec7 th\u1ed1ng l\u1ed7i sau khi ghi transaction log xu\u1ed1ng disk nh\u01b0ng tr\u01b0\u1edbc khi c\u1eadp nh\u1eadt thay \u0111\u1ed5i v\xe0o d\u1eef li\u1ec7u ch\xednh, storage engine v\u1eabn c\xf3 th\u1ec3 ph\u1ee5c h\u1ed3i c\xe1c thay \u0111\u1ed5i \u0111\xf3 \u0111\u01b0\u1ee3c."),(0,c.kt)("p",null,(0,c.kt)("img",{alt:"Transaction Log",src:a(6778).Z,width:"740",height:"636"})),(0,c.kt)("h3",{id:"6-autocommit"},"6. Autocommit"),(0,c.kt)("p",null,"M\u1eb7c \u0111\u1ecbnh c\xe1c c\xe2u l\u1ec7nh INSERT, UPDATE, DELETE \u0111\u01b0\u1ee3c g\xf3i trong c\xe1c transaction t\u1ea1m v\xe0 \u0111\u01b0\u1ee3c commit ngay khi n\xf3 ch\u1ea1y, \u0111\xe2y l\xe0 ch\u1ebf \u0111\u1ed9 AUTOCOMMIT. \u0110\u1ec3 b\u1eadt ch\u1ebf \u0111\u1ed9 n\xe0y ch\u1ea1y c\xe2u SET AUTOCOMMIT = 1; ng\u01b0\u1ee3c l\u1ea1i th\xec SET AUTOCOMMIT = 0. M\u1ed9t s\u1ed1 c\xe2u l\u1ec7nh \u0111\u1eb7c bi\u1ec7t c\xf3 th\u1ec3 l\xe0m transaction commit khi n\u1eb1m trong m\u1ed9t transaction \u0111ang m\u1edf, v\xed d\u1ee5 nh\u01b0 c\xe1c c\xe2u l\u1ec7nh DDL.\nTa c\xf3 th\u1ec3 c\xe0i \u0111\u1eb7t isolation level cho MySQL b\u1eb1ng vi\u1ec7c ch\u1ea1y c\xe2u l\u1ec7nh SET TRANSACTION ISOLATION LEVEL, sau khi ch\u1ea1y th\xec isolation level n\xe0y s\u1ebd c\xf3 hi\u1ec7u d\u1ee5ng trong c\xe1c transaction ti\u1ebfp theo. Ta c\xf3 th\u1ec3 c\xe0i \u0111\u1eb7t trong file c\u1ea5u h\xecnh cho c\u1ea3 server, ho\u1eb7c l\xe0 ch\u1ec9 set trong phi\xean l\xe0m vi\u1ec7c c\u1ee7a ta "),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-mysql"},"SET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED;\n")),(0,c.kt)("p",null,"Ta kh\xf4ng n\xean x\u1eed l\xfd c\xe1c b\u1ea3ng c\xf3 kh\xe1c storage engine trong c\xf9ng m\u1ed9t transaction, v\xec c\xf3 m\u1ed9t s\u1ed1 storage engine s\u1ebd kh\xf4ng h\u1ed7 tr\u1ee3 vi\u1ec7c rollback d\u1eef li\u1ec7u (MyISAM storage engine), n\u1ebfu c\xf3 m\u1ed9t s\u1ed1 l\u1ed7i x\u1ea3y ra trong qu\xe1 tr\xecnh th\u1ef1c hi\u1ec7n transaction, s\u1ebd ch\u1ec9 c\xf3 m\u1ed9t s\u1ed1 b\u1ea3ng \u0111\u01b0\u1ee3c rollback l\u1ea1i khi\u1ebfn l\xe0m m\u1ea5t \u0111i t\xednh Consistency."))}g.isMDXComponent=!0},7959:(n,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/acid-8932890988825239e3b0ba3afb39206a.PNG"},8532:(n,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/deadlock-f575d25cdb29225a1b0ebebaebeaa4ca.JPEG"},4466:(n,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/isolation_levels-d31e1dbaccc5a3acbd8a45093e79433c.PNG"},6778:(n,t,a)=>{a.d(t,{Z:()=>i});const i=a.p+"assets/images/transaction_log-ed06e47eebdd08b13fed212c7e595b00.PNG"}}]);